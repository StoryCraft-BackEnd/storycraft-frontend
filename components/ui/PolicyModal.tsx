/**
 * 정책 모달 컴포넌트
 * 개인정보 처리방침과 서비스 이용약관을 표시하는 모달 컴포넌트입니다.
 * 사용자가 설정 화면에서 정책 관련 버튼을 클릭했을 때 나타나는 전체 화면 모달로,
 * 스크롤 가능한 긴 텍스트 내용을 보여주고 닫기 버튼을 통해 모달을 닫을 수 있습니다.
 */

// React: React 라이브러리의 기본 기능들
import React from 'react';
// React Native: 네이티브 UI 컴포넌트들
import {
  View, // 컨테이너 컴포넌트 (div와 비슷한 역할)
  Text, // 텍스트 표시 컴포넌트
  Modal, // 모달 컴포넌트 (전체 화면 오버레이)
  TouchableOpacity, // 터치 가능한 버튼 컴포넌트
  ScrollView, // 스크롤 가능한 컨테이너
  SafeAreaView, // 안전 영역을 고려한 컨테이너
  StyleSheet, // 스타일시트 생성 함수
} from 'react-native';
// Expo Vector Icons: 닫기 아이콘
import { MaterialIcons } from '@expo/vector-icons';

/**
 * 정책 모달 컴포넌트의 Props 인터페이스
 * @interface PolicyModalProps
 * @property {boolean} visible - 모달 표시 여부
 * @property {() => void} onClose - 모달 닫기 함수
 * @property {'privacy' | 'terms'} type - 정책 타입 ('privacy': 개인정보처리방침, 'terms': 이용약관)
 */
interface PolicyModalProps {
  visible: boolean; // 모달 표시 여부
  onClose: () => void; // 모달 닫기 함수
  type: 'privacy' | 'terms'; // 정책 타입 ('privacy': 개인정보처리방침, 'terms': 이용약관)
}

/**
 * 정책 모달 컴포넌트
 * 개인정보 처리방침과 서비스 이용약관을 표시하는 모달입니다.
 * @param {PolicyModalProps} props - 컴포넌트 props
 * @returns JSX.Element - 정책 모달 컴포넌트
 */
const PolicyModal: React.FC<PolicyModalProps> = ({ visible, onClose, type }) => {
  /**
   * 정책 타입에 따른 제목 반환 함수
   * @returns {string} - 정책 제목 ('개인정보 처리방침' 또는 '서비스 이용약관')
   */
  const getTitle = () => {
    return type === 'privacy' ? '개인정보 처리방침' : '서비스 이용약관';
  };

  /**
   * 정책 타입에 따른 내용 반환 함수
   * @returns {string} - 정책 내용 (개인정보 처리방침 또는 서비스 이용약관)
   */
  const getContent = () => {
    if (type === 'privacy') {
      // 개인정보 처리방침 내용
      return `개인정보 처리방침

제1조 (개인정보의 처리 목적)
StoryCraft는 다음의 목적을 위하여 개인정보를 처리하고 있으며, 다음의 목적 이외의 용도로는 이용하지 않습니다.
- 회원 가입 및 관리
- 서비스 제공 및 운영
- 고객 상담 및 문의 응대

제2조 (개인정보의 처리 및 보유 기간)
① StoryCraft는 법령에 따른 개인정보 보유·이용기간 또는 정보주체로부터 개인정보를 수집 시에 동의받은 개인정보 보유·이용기간 내에서 개인정보를 처리·보유합니다.
② 각각의 개인정보 처리 및 보유 기간은 다음과 같습니다.
- 회원가입 및 관리: 서비스 이용계약 또는 회원가입 해지시까지
- 서비스 제공: 서비스 제공 완료시까지

제3조 (개인정보의 제3자 제공)
① StoryCraft는 정보주체의 개인정보를 제1조(개인정보의 처리 목적)에서 명시한 범위 내에서만 처리하며, 정보주체의 동의, 법률의 특별한 규정 등 개인정보 보호법 제17조 및 제18조에 해당하는 경우에만 개인정보를 제3자에게 제공합니다.

제4조 (개인정보처리의 위탁)
① StoryCraft는 원활한 개인정보 업무처리를 위하여 다음과 같이 개인정보 처리업무를 위탁하고 있습니다.
- 위탁받는 자 (수탁자): AWS, Google Cloud
- 위탁하는 업무의 내용: 서버 호스팅 및 데이터 저장

제5조 (정보주체의 권리·의무 및 그 행사방법)
① 정보주체는 StoryCraft에 대해 언제든지 개인정보 열람·정정·삭제·처리정지 요구 등의 권리를 행사할 수 있습니다.
② 제1항에 따른 권리 행사는 StoryCraft에 대해 서면, 전화, 전자우편, 모사전송(FAX) 등을 통하여 하실 수 있으며 StoryCraft는 이에 대해 지체없이 조치하겠습니다.

제6조 (처리하는 개인정보의 항목)
StoryCraft는 다음의 개인정보 항목을 처리하고 있습니다.
- 필수항목: 이메일 주소, 비밀번호
- 선택항목: 프로필 정보 (이름, 나이, 성별)

제7조 (개인정보의 파기)
StoryCraft는 개인정보 보유기간의 경과, 처리목적 달성 등 개인정보가 불필요하게 되었을 때에는 지체없이 해당 개인정보를 파기합니다.

제8조 (개인정보의 안전성 확보 조치)
StoryCraft는 개인정보보호법 제29조에 따라 다음과 같은 안전성 확보 조치를 취하고 있습니다.
- 개인정보의 암호화
- 해킹 등에 대비한 기술적 대책
- 개인정보에 대한 접근 제한

제9조 (개인정보 보호책임자)
① StoryCraft는 개인정보 처리에 관한 업무를 총괄해서 책임지고, 개인정보 처리와 관련한 정보주체의 불만처리 및 피해구제 등을 위하여 아래와 같이 개인정보 보호책임자를 지정하고 있습니다.
- 개인정보 보호책임자
- 연락처: privacy@storycraft.com

제10조 (개인정보 처리방침의 변경)
이 개인정보처리방침은 시행일로부터 적용되며, 법령 및 방침에 따른 변경내용의 추가, 삭제 및 정정이 있는 경우에는 변경사항의 시행 7일 전부터 공지사항을 통하여 고지할 것입니다.`;
    } else {
      // 서비스 이용약관 내용
      return `서비스 이용약관

제1조 (목적)
이 약관은 StoryCraft(이하 "회사")가 제공하는 StoryCraft 서비스(이하 "서비스")의 이용과 관련하여 회사와 회원과의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다.

제2조 (정의)
① "서비스"라 함은 회사가 제공하는 동화 생성, 영어 학습, 퀴즈 등의 서비스를 의미합니다.
② "회원"이라 함은 회사의 서비스에 접속하여 이 약관에 따라 회사와 이용계약을 체결하고 회사가 제공하는 서비스를 이용하는 고객을 말합니다.
③ "계정"이라 함은 회원의 식별과 서비스 이용을 위하여 회원이 선정하고 회사가 승인하는 문자, 숫자 또는 특수문자의 조합을 의미합니다.

제3조 (약관의 효력 및 변경)
① 이 약관은 서비스를 이용하고자 하는 모든 회원에 대하여 그 효력을 발생합니다.
② 회사는 필요한 경우 관련법령을 위배하지 않는 범위에서 이 약관을 변경할 수 있습니다.
③ 약관이 변경되는 경우, 회사는 변경사항을 시행일자 7일 전부터 공지사항을 통해 공지합니다.

제4조 (서비스의 제공)
① 회사는 다음과 같은 서비스를 제공합니다.
- AI 기반 동화 생성 서비스
- 영어 학습 서비스
- 퀴즈 및 학습 진도 관리 서비스
- 개인화된 학습 콘텐츠 제공

제5조 (서비스 이용)
① 서비스 이용은 회사의 업무상 또는 기술상 특별한 지장이 없는 한 연중무휴, 1일 24시간 운영을 원칙으로 합니다.
② 회사는 서비스의 제공에 필요한 경우 정기점검을 실시할 수 있으며, 정기점검시간은 서비스제공화면에 공지한 바에 따릅니다.

제6조 (회원가입)
① 회원은 회사가 정한 가입 양식에 따라 회원정보를 기입한 후 이 약관에 동의한다는 의사표시를 함으로서 회원가입을 신청합니다.
② 회사는 제1항과 같이 회원으로 가입할 것을 신청한 이용자 중 다음 각호에 해당하지 않는 한 회원으로 등록합니다.
- 가입신청자가 이 약관에 의하여 이전에 회원자격을 상실한 적이 있는 경우
- 등록 내용에 허위, 기재누락, 오기가 있는 경우
- 기타 회원으로 등록하는 것이 회사의 기술상 현저히 지장이 있다고 판단되는 경우

제7조 (회원의 의무)
① 회원은 다음 행위를 하여서는 안됩니다.
- 신청 또는 변경 시 허위내용의 등록
- 타인의 정보 도용
- 회사가 게시한 정보의 변경
- 회사가 정한 정보 이외의 정보(컴퓨터 프로그램 등) 등의 송신 또는 게시
- 회사 기타 제3자의 저작권 등 지적재산권에 대한 침해
- 회사 기타 제3자의 명예를 손상시키거나 업무를 방해하는 행위
- 외설 또는 폭력적인 메시지, 화상, 음성, 기타 공서양속에 반하는 정보를 서비스에 공개 또는 게시하는 행위

제8조 (회사의 의무)
① 회사는 관련법령과 이 약관이 금지하거나 공서양속에 반하는 행위를 하지 않으며 이 약관이 정하는 바에 따라 지속적이고, 안정적으로 서비스를 제공하기 위하여 노력합니다.
② 회사는 회원이 안전하게 서비스를 이용할 수 있도록 개인정보(신용정보 포함) 보호를 위한 보안 시스템을 구축하고 개인정보처리방침을 공시하고 준수합니다.

제9조 (개인정보보호)
① 회사는 관계법령이 정하는 바에 따라 회원의 개인정보를 보호하기 위해 노력합니다. 개인정보의 보호 및 사용에 대해서는 관련법령 및 회사의 개인정보처리방침이 적용됩니다.

제10조 (서비스의 중단)
① 회사는 컴퓨터 등 정보통신설비의 보수점검, 교체 및 고장, 통신의 두절 등의 사유가 발생한 경우에는 서비스의 제공을 일시적으로 중단할 수 있습니다.
② 회사는 제1항의 사유로 서비스의 제공이 일시적으로 중단됨으로 인하여 회원 또는 제3자가 입은 손해에 대하여 배상합니다. 단, 회사가 고의 또는 과실이 없음을 입증하는 경우에는 그러하지 아니합니다.

제11조 (계약해지 및 이용제한)
① 회원은 회사에 언제든지 탈퇴를 요청할 수 있으며 회사는 즉시 회원탈퇴를 처리합니다.
② 회사는 회원이 이 약관의 의무를 위반하거나 서비스의 정상적인 운영을 방해한 경우, 경고, 일시정지, 영구이용정지 등으로 서비스 이용을 단계적으로 제한할 수 있습니다.

제12조 (면책조항)
① 회사는 천재지변 또는 이에 준하는 불가항력으로 인하여 서비스를 제공할 수 없는 경우에는 서비스 제공에 관한 책임이 면제됩니다.
② 회사는 회원의 귀책사유로 인한 서비스 이용의 장애에 대하여는 책임을 지지 않습니다.

제13조 (분쟁해결)
① 회사는 회원이 제기하는 정당한 의견이나 불만을 반영하고 그 피해를 보상처리하기 위하여 피해보상처리기구를 설치·운영합니다.
② 회사와 회원 간에 발생한 전자상거래 분쟁에 관하여는 소비자분쟁조정위원회의 조정에 따를 수 있습니다.

제14조 (재판권 및 준거법)
① 회사와 회원 간에 발생한 분쟁에 관하여는 대한민국 법을 적용합니다.
② 회사와 회원 간에 제기된 소송에는 대한민국의 법원을 관할법원으로 합니다.`;
    }
  };

  // 메인 모달 렌더링
  return (
    <Modal
      visible={visible} // 모달 표시 여부
      animationType="slide" // 슬라이드 애니메이션
      presentationStyle="pageSheet" // 페이지 시트 스타일 (iOS)
      onRequestClose={onClose} // 모달 닫기 요청 시 호출되는 함수
    >
      <SafeAreaView style={styles.container}>
        {/* 모달 헤더 (닫기 버튼, 제목, 공간 채우기) */}
        <View style={styles.header}>
          <TouchableOpacity onPress={onClose} style={styles.closeButton}>
            <MaterialIcons name="close" size={24} color="#fff" /> {/* 닫기 아이콘 */}
          </TouchableOpacity>
          <Text style={styles.title}>{getTitle()}</Text> {/* 정책 제목 */}
          <View style={styles.placeholder} /> {/* 공간 채우기 (닫기 버튼과 균형 맞추기) */}
        </View>
        {/* 스크롤 가능한 정책 내용 */}
        <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>
          <Text style={styles.contentText}>{getContent()}</Text> {/* 정책 내용 텍스트 */}
        </ScrollView>
      </SafeAreaView>
    </Modal>
  );
};

// 모달 컴포넌트 스타일 정의
const styles = StyleSheet.create({
  container: {
    flex: 1, // 전체 화면 차지
    backgroundColor: '#1a1a2e', // 어두운 배경색
  },
  header: {
    flexDirection: 'row', // 가로 방향 배치
    alignItems: 'center', // 세로 중앙 정렬
    justifyContent: 'space-between', // 양 끝 정렬
    paddingHorizontal: 20, // 좌우 패딩
    paddingVertical: 15, // 상하 패딩
    borderBottomWidth: 1, // 하단 테두리 두께
    borderBottomColor: '#2a2a3e', // 하단 테두리 색상
  },
  closeButton: {
    padding: 5, // 버튼 내부 패딩
  },
  title: {
    fontSize: 18, // 제목 폰트 크기
    fontWeight: 'bold', // 굵은 글씨
    color: '#fff', // 흰색 텍스트
    flex: 1, // 남은 공간 차지
    textAlign: 'center', // 텍스트 중앙 정렬
  },
  placeholder: {
    width: 34, // 닫기 버튼과 동일한 너비 (균형 맞추기)
  },
  content: {
    flex: 1, // 남은 공간 차지
    paddingHorizontal: 20, // 좌우 패딩
  },
  contentText: {
    fontSize: 14, // 내용 텍스트 크기
    lineHeight: 22, // 줄 간격
    color: '#e0e0e0', // 밝은 회색 텍스트
    paddingVertical: 20, // 상하 패딩
  },
});

export default PolicyModal;
