name: Project Auto Link # 워크플로우 이름

on:
  pull_request_target:
    types: [opened] # PR 생성 시 작동

jobs:
  link:
    runs-on: ubuntu-latest # Ubuntu 환경
    steps:
      - name: Auto Link to Project
        uses: actions/github-script@v6 # GitHub API를 사용하기 위한 액션
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }} # GitHub 인증
          script: |
            const { owner, repo } = context.repo;
            const pr = context.payload.pull_request;

            // 프로젝트 ID (GitHub 프로젝트 URL에서 확인 가능)
            const projectId = 'your-project-id';  // 여기에 프로젝트 ID를 추가하세요

            // PR을 프로젝트에 연결
            await github.graphql(`
              mutation {
                addProjectV2Item(input: {
                  projectId: "${projectId}"
                  contentId: "${pr.node_id}"
                }) {
                  item {
                    id
                  }
                }
              }
            `);

# 이메일 알림 비활성화
notifications:
  email: false
